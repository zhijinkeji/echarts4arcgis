// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttachmentsStoreSerializer","esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all ./AttributesUtil ./NotesUtil ./CustomAttachmentsStore esri/dijit/geoenrichment/utils/ImageInfoUtil".split(" "),function(e,f,r,t,d,l){return{getAttachmentsStoreJson:function(a,m){function n(a){b=b||{};for(var c in b)if(b[c]===a)return c;c="image_"+d++;b[c]=a;return c}function p(){return f([m.saveImages&&a.getImages(),a.getAttributes(),
a.getNotes()]).then(function(a){var c=a[0]||[],b=a[1]||[],d=a[2]||[];return f(c.map(function(a){return f([e(a.getThumbnail(),function(a){return l.ensureDataUrlForRemoveImage(a)}),e(a.getUrl(),function(a){return l.ensureDataUrlForRemoveImage(a)})]).then(function(q){a.__thumbnail=n(q[0]);a.__url=n(q[1])})})).then(function(){return{images:c.map(function(a){var b=a.__thumbnail,c=a.__url;delete a.__thumbnail;delete a.__url;return{description:a.description,thumbnail:b,url:c,filename:a.filename,imageViewType:a.imageViewType}}),
attributes:b.map(function(a){return r.attributeToJson(a)}),notes:d.map(function(a){return t.noteToJson(a)})}})})}if(!a)return null;var d=0,b,g=[],h=[];if(a.supportsMultipleAreas)for(var k=0;k<m.numAreas;k++)a.setCurrentAnalysisAreaIndex(k),h.push(e(p(),function(a){g.push(a)}));else h.push(e(p(),function(a){g.push(a)}));return f(h).then(function(){return{supportsMultipleAreas:a.supportsMultipleAreas,areaAttachments:g,imageDataCache:b}})},getAttachmentsStoreFromJson:function(a){return a&&new d(a)}}});