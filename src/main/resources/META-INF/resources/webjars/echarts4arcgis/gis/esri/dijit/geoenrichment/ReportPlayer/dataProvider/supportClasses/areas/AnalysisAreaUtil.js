// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AnalysisAreaUtil",["dojo/_base/lang","esri/geometry/webMercatorUtils","esri/dijit/geoenrichment/utils/CoordinateUtil"],function(l,m,d){var k={geometryToLatLong:function(a){var c=a.spatialReference.wkid;return c===d.WGS_84_WKID?{STORE_LONG:a.x,STORE_LAT:a.y}:d.isWebMercator(c)?(a=m.xyToLngLat(a.x,a.y),{STORE_LONG:a[0],STORE_LAT:a[1]}):null},populateCombinedAreasInfo:function(a,c){var e={},b={};c.forEach(function(a){a.latitude&&
(e[a.latitude]=1);a.longitude&&(b[a.longitude]=1)});a.name=a.name||c.map(function(a){return a.name}).join(", ");a.shortName=a.shortName||c.map(function(a){return a.shortName||a.name}).join(", ");a.description=a.description||c.map(function(a){return a.description||a.name}).join(", ");a.address=a.address||c.map(function(a){return a.address||a.name}).join(", ");a.latitude=a.latitude||Object.keys(e).join(", ");a.longitude=a.longitude||Object.keys(b).join(", ");return a},groupAreas:function(a){function c(a){var b=
a.locationName||a.name;return{isSingleAreaGroup:!0,label:b,hideGroupLabel:b===(a.shortName||a.name),areas:[a]}}var e=a.combinedAreasInfo&&a.combinedAreasInfo.groups||[],b=[],h=[],g={};a.analysisAreas.forEach(function(f){if(!(a.filter&&!a.filter(f)||f.hidden))if(f.isGrouped){if(!g[f.groupIndex]){var d=e[f.groupIndex],d=g[f.groupIndex]={isRealGroup:!0,label:d.locationName||d.name,areas:[]};h.push(d);b.push(d)}g[f.groupIndex].areas.push(f)}else b.push(c(f))});var d;1===b.length&&b[0].isRealGroup&&(b=
b[0].areas.map(c),h.length=0,d=!0);return{groupInfos:b,isOnlyAreasInOnlyGroup:d}},parseSites:function(a){if(a.sites){a.analysisAreas=[];a.sites.forEach(function(e){e.areas.forEach(function(b){a.analysisAreas.push(b)})});a.combinedAreasInfo={groups:a.sites.map(function(e){var b=l.mixin({},e);delete b.areas;delete b.attributes;delete b.notes;delete b.images;b.indexes=e.areas.map(function(b){return a.analysisAreas.indexOf(b)});return b})};k.populateCombinedAreasInfo(a.combinedAreasInfo,a.sites);if(!a.attachmentsProvider||
!a.attachmentsProvider.getAttributesForAreaAt){a.attachmentsProvider={};a.attachmentsProvider.supportsMultipleAreas=1<a.sites.length;var c=a.attachmentsProvider.areaAttachments=[];a.sites.forEach(function(a){a.areas.forEach(function(b){c.push({attributes:a.attributes,notes:a.notes,images:a.images})})})}delete a.sites}}};return k});