// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/geoenrichment/templates/ImageNavigator.html":'\x3cdiv class\x3d"esriGEImageNavigator esriGENonSelectable"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"singleImageView"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"imageContainerOuter" class\x3d"imageNavigator_imageContainerOuter"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageContainer" class\x3d"imageNavigator_imageContainer"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"imagePaginationDiv" class\x3d"esriGEAbsoluteStretched"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"imageNoteContainerDiv" class\x3d"imageNavigator_imageNoteContainerDiv"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"imageNoteLabel" class\x3d"imageNavigator_imageNoteLabel"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"prevImageButton" class\x3d"imageNavigator_prevImageButton esriGEImageNavigatorPaginationLeftButton"\x3e\x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"nextImageButton" class\x3d"imageNavigator_nextImageButton esriGEImageNavigatorPaginationRightButton"\x3e\x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"thumbnailListDiv" class\x3d"imageNavigator_thumbnailContainerDiv"\x3e\x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"navigatorLabel" class\x3d"imageNavigator_navigatorLabel"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"noImagePlaceHolder" class\x3d"imageNavigator_noImagePlaceHolder"\x3e\r\n            \x3cdiv class\x3d"imageNavigator_noImagePlaceHolderImage noImage"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"imageNavigator_noImagePlaceHolderLabel"\x3e${nls.noImage}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"showAllImagesButton" class\x3d"imageNavigator_showAllImagesButton"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"allImagesView" class\x3d"imageNavigator_allImagesView"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"allImagesListDiv"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("esri/dijit/geoenrichment/ImageNavigator","require dojo/_base/declare dojo/on esri/dijit/geoenrichment/when dojo/string dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin ./Pagination ./lists/FlowList ./utils/DeviceUtil ./utils/DnDUtil ./utils/DomUtil ./utils/WaitingUtil ./ReportPlayer/core/annotations/utils/CircularMaskUtil ./ReportPlayer/ReportPlayerState dojo/text!./templates/ImageNavigator.html dojo/i18n!../../nls/jsapi".split(" "),function(v,h,n,k,w,f,g,x,y,z,A,
m,p,e,r,B,t,C,l){function u(a,b,c){c=c||{};r.showProgress(b);var d=c.loadFullImage&&a.getUrl&&a.getUrl();return k(a.getThumbnail(),function(e){r.removeProgress(b);if(e){var f=function(d){var e=g.create("div",{"class":"imageNode esriGEAbsoluteStretched"},b);e.style.backgroundImage="url("+d+")";c.useCircularMask?setTimeout(function(){B.setCircularMask(c.useCircularMask,e,d)}):c.scaleToCover&&(e.style.backgroundSize="cover");"360"===a.imageViewType?g.create("span",{"class":"imageNavigator_watermark360"},
e):"pano"===a.imageViewType&&g.create("span",{"class":"imageNavigator_watermarkPano"},e);return e};f(e);d&&k(d).then(function(a){return a&&f(a)})}else c.pagination?e=g.create("div",{"class":"thumbnailIsUnavailable",innerHTML:l.previewNotAvailable},b):(e=g.create("div",{"class":"imageNode esriGEAbsoluteStretched noImage"},b),e.style.backgroundImage="")})}l=l.geoenrichment.dijit.ReportPlayer.ImageNavigator;var D=h(null,{createPresentation:function(a,b,c,d){c=g.create("div",{"class":"imageThumbnailListItemRoot"},
c);u(a,c);this.selectPresentation(c,b);return c},selectPresentation:function(a,b){f[b?"add":"remove"](a,"imageThumbnailListItemRootSelected")}}),q;h=h([x,y],{templateString:C,nls:l,showNotes:!0,showThumbnails:!1,showNavigationLabel:!1,enableAllImagesButton:!0,loadFullImages:!1,canShowViewer:!1,pagination:null,thumbnailList:null,allImagesList:null,postCreate:function(){this.inherited(arguments);this._initPagination();this._initThumbnailsList();this._updateUI();e.hide(this.noImagePlaceHolder);this._addImageListeners();
this._setViewMode("singleImage");f[m.isMobileDevice()?"add":"remove"](this.domNode,"mobile")},_initThumbnailsList:function(){this.showThumbnails&&(this.thumbnailList=this._createAllImagesList(this.thumbnailListDiv))},_initAllImagesList:function(){this.allImagesList||(this.allImagesList=this._createAllImagesList(this.allImagesListDiv,"esriGEAbsoluteStretched"));this.allImagesList.setItems(this._images,!0);this.allImagesList.setSelectedIndex(this._imageIndex);this.allImagesList.domNode.style.height=
this._height+"px"},_createAllImagesList:function(a,b){var c=this,d=(new A({"class":"imageThumbnailList "+(b||""),items:[],itemRenderer:new D,noDragTolerance:m.isMobileDevice()?p.MOBILE_TOLERANCE:0,onChange:function(){c._imageIndex=d.items.indexOf(d.selectedItem);c._setViewMode("singleImage");c._showImage()}})).placeAt(a);this.own(d);return d},_initPagination:function(){var a=this;this.pagination=(new z({createItemContainer:function(){var b=g.create("div",{"class":"imageNavigator_imagePaginationRoot"});
0<a._containerHeight&&(b.style.height=a._containerHeight+"px");p.addNoDragClickHandler(b,function(){a._onImageClicked(b)},{tolerance:m.isMobileDevice()?p.MOBILE_TOLERANCE:2});return b},updateItemContainer:function(b,c){g.empty(b);a.onContentLoadingStart();k(u(c,b,{useCircularMask:a._useCircularMask,scaleToCover:a._scaleToCover,pagination:!0,loadFullImage:a.loadFullImages}),function(){a.onContentLoadingEnd()})},scrollAnimation:"slide",autoCenter:"$stretch:1,1"})).placeAt(this.imagePaginationDiv);this.own(this.pagination);
this.pagination.set("items",[]);this.pagination.startup()},_onImageClicked:function(a){var b=this,c=this._getCurrentImage();this.canShowViewer&&!m.isMobileDevice()?q?require([q],function(a){a.showViewer(c,b._images)}):v(["./PanoramicViewer/PanoramicViewer"],function(a){a.showViewer(c,b._images,{onClose:function(){setTimeout(function(){t.isImageViewerShown=!1},300)}});t.isImageViewerShown=!0}):k(c&&c.getUrl&&c.getUrl(),function(a){a&&window.open(a,"_blank")})},_updateUI:function(){e[this.showNotes?
"show":"hide"](this.imageNoteContainerDiv);e[this.showThumbnails?"show":"hide"](this.thumbnailListDiv);e[this.showNavigationLabel?"show":"hide"](this.navigatorLabel)},_imageIndex:0,_addImageListeners:function(){var a=this;n(this.prevImageButton,"click",function(){0!=a._imageIndex&&(a._imageIndex--,a._showImage())});n(this.nextImageButton,"click",function(){a._imageIndex!=a._images.length-1&&(a._imageIndex++,a._showImage())});this.enableAllImagesButton&&n(this.showAllImagesButton,"click",function(){a._setViewMode("allImages")})},
_updateImageButtons:function(){f[0<this._imageIndex?"remove":"add"](this.prevImageButton,"esriGEImageNavigatorPaginationLeftButtonDisabled");f[this._imageIndex<this._images.length-1?"remove":"add"](this.nextImageButton,"esriGEImageNavigatorPaginationRightButtonDisabled")},_getCurrentImage:function(){return this._images[this._imageIndex]},_showImage:function(){var a=this._getCurrentImage();a?(e.show(this.imageContainerOuter),e.hide(this.noImagePlaceHolder),this.pagination.resize(),this.pagination.set("currentPage",
this._imageIndex),this._imageIndex=this.pagination.currentPage,this.thumbnailList&&this.thumbnailList.setSelectedIndex(this._imageIndex)):(e.hide(this.imageContainerOuter),e.show(this.noImagePlaceHolder));f[a?"remove":"add"](this.domNode,"hasNoImages");this._updateImageButtons();this._updateNavigatorLabel();this._showNote()},_updateNavigatorLabel:function(){this.navigatorLabel.innerHTML=w.substitute(l.paginationLabel,{n:this._imageIndex+1,m:this._images.length})},_showNote:function(){var a=this._getCurrentImage();
this.imageNoteLabel.innerHTML=a&&a.description||"";this.imageNoteContainerDiv.style.visibility=this.imageNoteLabel.innerHTML?"visible":"hidden"},_attachmentStore:null,_useCircularMask:null,_scaleToCover:null,update:function(a,b){b=b||{};var c=a&&(!this._attachmentStore||this._attachmentStore._site!==a._site);this._attachmentStore=a||this._attachmentStore;this._updateWithAdditionalParameters(b);this._updateUI();c&&(this._images=[],this._imageIndex=0,this.pagination.set("items",[]),this._showImage());
var d=this;return k(this._attachmentStore&&this._attachmentStore.getImages(),function(a){d._images=a||[];"number"===typeof b.imageIndex&&(d._imageIndex=Math.min(b.imageIndex,d._images.length-1));d.pagination.set("items",d._images);d._showImage();d.thumbnailList&&(d.thumbnailList.setItems(d._images),d.thumbnailList.setSelectedIndex(d._imageIndex));d._height&&d.setHeight(d._height)})},_updateWithAdditionalParameters:function(a){this._useCircularMask=a.useCircularMask;f[a.alwaysShowCaptions?"add":"remove"](this.domNode,
"fixedCaptions");this._scaleToCover=a.scaleToCover},_mode:null,_setViewMode:function(a){e.hide([this.singleImageView,this.allImagesView]);"singleImage"==a?e.show(this.singleImageView):(e.show(this.allImagesView),this._initAllImagesList());this._mode=a},isAllImagesShown:function(){return"allImages"===this._mode},getImageIndex:function(){return this._imageIndex},setImageIndex:function(a){this._imageIndex=a;this._showImage()},_height:0,_containerHeight:0,setHeight:function(a){this._height=a;this._containerHeight=
a-(this.showThumbnails?50:0);this.imageContainer.style.height=this._containerHeight+"px";this.noImagePlaceHolder.style.paddingTop=(a-169)/2+"px";a=(this._containerHeight-this.prevImageButton.clientHeight)/2;this.prevImageButton.style.top=a+"px";this.nextImageButton.style.top=a+"px";this.pagination.resize();this.allImagesList&&(this.allImagesList.domNode.style.height=this._height+"px")},onContentLoadingStart:function(){},onContentLoadingEnd:function(){}});h.setViewerPath=function(a){q=a};return h});