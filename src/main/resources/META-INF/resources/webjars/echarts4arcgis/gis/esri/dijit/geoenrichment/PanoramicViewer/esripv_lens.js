var t;(t=this).BAIV3&&!t.BAIVLENS&&function(t,G){"use strict";var e="0.11.0",i={three:"^0.105.2"},n=e.split(".")[1],o=i.three.split(".")[1],s=i.three.replace(/[^0-9.]/g,""),a={ORBIT:0,DEVICEORIENTATION:1},r={UNKNOWN:0,NORMAL:1,CARDBOARD:2,STEREO:3},v={Info:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADBklEQVR42u2bP08UQRiHnzFaSYCI/xoksdBIqGwIiYWRUBISExpCQ0ej38FWOmlIKKhoMPEbaCxsrrHiYrQgOSlQEaICrT+LHSPZzNzt3s3c3Hn7lHvLzvv82L2dm30XKioqKgYY062BJF0HpoA7wARwBbhsPz4DjoEG8AnYNcZ8Sx1Op8IXJM1KWpdUV3nq9m9nJV1I7VNGfEzSM0mNNqR9NOwxx1L7NRMflbQm6SSgeJ4TO8Zoat+8/LKkg4jieQ4kLaf2RtKwpJ0uiufZkTScSn5S0l5C+b/sSZrstvyMpKPU5uc4kjTTjkvpeYCkaeA1/+7hvcIZMGuMqUULQNIU8Aa4ltrWwyHwyBizGzwASSPAe+B2assW7AH3jTE/i+xcZoa12Qfy2Bo3i+5cKABl99zF1GYlWFTBeULLS0DZrOsDcDNggTXgc27bLWA64BhfgHvGmB8dHUXZ1DM0S45xliKMs9bKr+klIOkqsBrwv9JtVq1DewEAT4Ch1BYdMGQdygeg7Df4SmqDAKyoyXpCszPgITCeuvoAjFuX0gE8jljUdv7bCtiOOJ7XpdUZ8L/gdXHOA5QtYH5NXXVgbrgWWn1nwFTqaiPgdPIFcDd1tRFwOl307DwRuZgXwLvctgfA04hjOp18AcReZ6sZY16e3yDpUuQxnU6+S2AkcjEpcDr1zxOXSPgCKLSa0mc4nXwB/EpdbQScTr4AGqmrjYDTyRfAx9TVRsDp5Aug8LJyH+F0cgZg58z11BUHpO5ruGh2G3ybuuqAeF2aBfAqddUB8bq0OgP2U1cegH3aOQOMMb+BrdTVB2DLupQLwLIOnKY26IBT6+ClaQDGmO/ARmqLDtiwDn7HVkcY+EdjNoTlCI+tYhO2iUppm6HKslPUq2qQKHpUe8AFsjaUXuUQWCgqXyoAG8IuME/WkNRrnAHzZfqDSgdgQ6gBc2Td3b3CMTBXtkOsIzTIjZLnQhjcVtlcEIPZLJ0LoVvt8s/Va+3yuSAG84UJRxB98cpM9dJURUVFxSDzBxKde4Lk3/h2AAAAAElFTkSuQmCC",Arrow:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADPklEQVR42u2bMUscQRiG30/SRaJEI1ZKUiRErNIELRUbQYSAnX8hpVUgkDYp0wgWVjYW+QcJaQzYpLojJIXhtDDEKBpj65ti58ixmdmb2ZvZ7+T2AUHudmfmeXf2bnb3O6CmpqZmgJGqOiI5AWAWwEMA0wDuArht3r4CcAagBeAbgIaI/NQOp1fhIZKLJN+SbDKcptl3keSQtk+I+BjJVyRbJaRdtEybY9p+ReKjJN+QvIwonufS9DGq7ZuXXyd5nFA8zzHJdW1vkLxDcrdC8Ty7JO9oyc+QPFCUb3NAcqZq+TmSp9rmHZySnCvjErwOIPkUwHv8+w7vF64ALIrIfrIASM4C+ADgnratgxMACyLSiB4AyREAnwE80LbswgGAJyJy4bNxyApr6wbIw4xxy3djrwCYfeeuaZsFsEbPdULXU4DZqusLgMkEA21P05EEbf8A8FhEzos28pkBLxLKL5s/r/M1kEkz9vKQHGeatf05yfmOfubNa7G5JDle5NhtBjwHMBz5yFwAWBaRT+0XzP8pZsKwcQiH2fX8Ycojb+kzxUw4ZJn7CSQXqpRPHMKCq7+iZJ71Mvdy/DftXSQ6HcJdSDaqPPKW/mPOBO+lcbvzCU35RCFM2PpwnQKzZQfdgfe0dxH5dLA6uQJ4pC2fIASrkyuA6X6QjxyC1ckVQNn7bNHlI4ZgdXIFUObiJJl8pBCsTjGfuIwA2Cv4FN7xbYjkjqsRAHuIePXoCiDF1Zk2VidXAL+1R5sAq5MrgJb2aBNgdXIF8FV7tAmwOrkCCFs73wysTtYATHFCU3vEEWm6Ci6KvgY/ao86Ik6XogDeaY86Ik6XbjPgSHvkEThCwQy45XpDRK5JbgN4GWkgUyR9H65MRQxgW0SunZ5FezK7pfwd8e8MV8UfAPdF5Jdrg8JrAbPjprZFD2wWyQP6j8ZSEufRmGlgQ9umBBvd5IOgbjFUKLu+XnWBhG+rpsFVZGUo/coJgFVf+aAATAgNACvICpL6jSsAKyH1QcEBmBD2ASwhq+7uF84ALIVWiPUEB7lQsiOEwS2VzQUxmMXSuRCqKpd/zX4rl88FMZg/mLAEcSN+MlP/aKqmpqZmkPkL0hSjwOpNKxwAAAAASUVORK5CYII=",FullscreenEnter:"data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KICAgIDxwYXRoIGQ9Ik03IDE0SDV2NWg1di0ySDd2LTN6bS0yLTRoMlY3aDNWNUg1djV6bTEyIDdoLTN2Mmg1di01aC0ydjN6TTE0IDV2MmgzdjNoMlY1aC01eiIvPgo8L3N2Zz4=",FullscreenLeave:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTE0LDE0SDE5VjE2SDE2VjE5SDE0VjE0TTUsMTRIMTBWMTlIOFYxNkg1VjE0TTgsNUgxMFYxMEg1VjhIOFY1TTE5LDhWMTBIMTRWNUgxNlY4SDE5WiIgLz48L3N2Zz4=",VideoPlay:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTgsNS4xNFYxOS4xNEwxOSwxMi4xNEw4LDUuMTRaIiAvPjwvc3ZnPg==",VideoPause:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTE0LDE5LjE0SDE4VjUuMTRIMTRNNiwxOS4xNEgxMFY1LjE0SDZWMTkuMTRaIiAvPjwvc3ZnPg==",WhiteTile:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIABAMAAAAGVsnJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB1WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjE8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlBob3RvbWV0cmljSW50ZXJwcmV0YXRpb24+MjwvdGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KAtiABQAAACRQTFRFAAAAAAAABgYGBwcHHh4eKysrx8fHy8vLzMzM7OzsAAAABgYG+q7SZgAAAAp0Uk5TAP7+/v7+/v7+/iJx/a8AAAOwSURBVHja7d0hbsNAEAVQo6SFI6XEcALDcgNLvUBvEBQVhpkWVYWlhSsVFS7t5QIshRt695lEASZP+8c7a1kzDL1fz+/zyuvzp6FbvoddrL6uDd1yGZ5eXldeb18N3fIx7A+58prmhm65DfvDcd0952lu6JabFbD/zVprZj1lzcys+fj9z8xTZtbT8rv8yWlu6BYAIgAAAAAAAAAAAABAM6QXEAEAAAAAAAAAgJ2gnaAIiIA3Q2qAGgAAAAAAAAAAAAAAAAAAAAAAAAAAQJsADkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBVlfAcZ3aeZobusUKMGBhV6KUElHGKBERJR6/fxExRkQZl9/lT8S1oVsuhqyYMmPKjCkzvfcCpsxohrwY0Q06EAEAAAAAAAAAAACgGdILiAAAAAAAAAAAwE7QTlAERMCbITVADQAAAAAAAAAAAAAAAAAAAAAAAAAAwKmwQ1ERAAAAAACPQY9BERABERABERABERABERABAAAAAAAAAICdoJ2gCIiAT2bUADVADRABEQAAQBFUBEVABERgEyvAlJm+V4ApM6bMmDJjyowpM6bMdN0LmDKjGfJiRDfoQAQAAAAAAAAAAACAZkgvIAIAAAAAAAAAADtBO0EREAFvhtQANQAAAAAAAAAAAAAAAAAAAAAAAAAAAKfCDkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBTawAU2b6XgGmzJgyY8qMKTOmzJgy03UvYMqMZsiLEd2gAxEAAAAAAAAAAAAAmiG9gAgAAAAAAAAAAOwE7QRFQAS8GVID1AAAAAAAAAAAAAAAAAAAAAAAAAAAAJwKOxQVAQAAAADwGPQYFAEREAEREAEREAEREAERAAAAAAAAAADYCdoJioAI+GRGDVAD1AAREAEAABRBRVAEREAENrECTJnpewWYMmPKjCkzpsyYMmPKTNe9gCkzmiEvRnSDDkQAAAAAAAAAAAAAaIb0AiIAAAAAAAAAALATtBMUARHwZkgNUAMAAAAAAAAAAAAAAAAAAAAAAAAAAHAq7FBUBAAAAADAY9BjUAREQAREQAREQAREQAREAAAAAAAAAABgJ2gnKAIi4JMZNUANUANEQAQAAFAEFUEREAER2MQKMGWm7xVgyowpM50PWen9ugNGXz1XaocAFgAAAABJRU5ErkJggg==",Setting:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADn0lEQVR42u2bzUsVURjGnyO6CPzAMnTjppAo3LTwH1CqTfaxbeOiRS37A0wXtROFVi1aRBs3LWohSIGbQAQXViBGRhG0UIRKUCpK7q/FnOB2uc6cOXNmRnGe3eW+H8/7zLln3vNxpQoVKlQ4wjBFJAFOSRqX1O7osivpvjHmU1nChBZglvSYLYJbS0EanCvIJzWK+gnsyH34/8OuMaYjb265jwCgz6N4SWq3vodbAEmnS/KtBDgoAgyU5BteAOAkMAPcBroc7PskDWfgN+wyDwBdltMMcDI3tYBnde/pHeARMNTErgd4APzweP834oeN1dMkz5DlsFNn/yyv4kdiSK4At4AO4CqwGaDwRmza2B0210qM7YhrXU59ANAq6bWkwQTTn5KO5fIE0uVYlXTeGLOXFMx1DrjlULwKKN41x6DlnIjEEQCckPRe0okCiguJr5LOGGO+xhm5jICJQ1i8LOeJJKPYEQAMKvrtt5ZdjSf2FM0Fq/sZJI2A6UNcvCz36TiDfUcAcE1SPu/U6Mm8k/TFfu6XdFb5iX3dGPM8lQfwNod3+TowBnQ3yddtv1vPIe+b1JIBiwEJ1IAJ208k5W21trWA+V/5CHAcmAtU/A2P/DcCiTAHHE8tgCVhgLvAXgYCk17Jo/yTGfLuWe7Zd72AC8CWB4n3OAz7mLytNkZabAEXMhfeQKYfWEpJZCxA3rGUOZeA/qDF15FpAz47EvlNk9neI2e3jeWCz0BbmvipNkSMMX8kuSZYM8Z8zyqAjbHmaN5mOeYjgIXrU93MWrxHrNQjrqiDkQMLHwG+OdqF3NN3jeXKzU8AoF1SzdH8XKhJUO7HZDXLMbwAwICkJUULFxe0SbqSVQAbw3Xi7Ze0ZLmGAzAKbHs0JGU1QtvAaIjCW4B7ZOvJy2qFa5a730RPtBiaz0CgnkiZi6F5fBZDVMvho7EhcuS3xJJ2hV9IupgTqaLw0hhzab8vq23xOG/r+LDsKjLgYVzxUnU0ltwK2wDezUyJmEwqXgp/PL4rvxthaeCSI+zxuA10J8ZkWdJNSb2SLkvayKHwDRu71+ZajrG941J8agALDQ3GU/a/IvMkYCPzmCbtLNEVmacNtgs5iP9fYVNEV1Q6Hez7yNZSL+J2SarTcpqiyV2iUkG0IvPFvbz5FbEn+KEk3wMjwMeSfCsBXFBdly9CAPk9ydyffpECuB5tZfVJjaKWueOSfinln6YK4lahQoUKRxd/AcRPGTcQCAUQAAAAAElFTkSuQmCC",ChevronRight:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTguNTksMTYuNThMMTMuMTcsMTJMOC41OSw3LjQxTDEwLDZMMTYsMTJMMTAsMThMOC41OSwxNi41OFoiIC8+PC9zdmc+",Check:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTIxLDdMOSwxOUwzLjUsMTMuNUw0LjkxLDEyLjA5TDksMTYuMTdMMTkuNTksNS41OUwyMSw3WiIgLz48L3N2Zz4=",ViewIndicator:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0idmlldy1pbmRpY2F0b3IiIGhlaWdodD0iMzAiIHdpZHRoPSIzMCIgdmlld0JveD0iLTIuNSAtMSAzMCAzMCI+Cgk8c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7ZmlsbDpub25lO30uc3Qxe3N0cm9rZS13aWR0aDo2O3N0cm9rZS1taXRlcmxpbWl0OjEwO30KCTwvc3R5bGU+Cgk8Zz4KCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNIDEyLjUgMCBBIDEyLjUgMTIuNSAwIDAgMCAtMTIuNSAwIEEgMTIuNSAxMi41IDAgMCAwIDEyLjUgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0gMTMgMCBMIDEwIDIgTCAxNiAyIFoiPjwvcGF0aD4KCQk8cGF0aCBjbGFzcz0ic3QyIiBkPSJNIDIgMCBBIDIgMiAwIDAgMCAtMiAwIEEgMiAyIDAgMCAwIDIgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDEiIGlkPSJpbmRpY2F0b3IiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTMsMTUuNSkiPjwvcGF0aD4KCTwvZz4KPC9zdmc+"},c={load:function(t,e,i,n){var o=1<arguments.length&&void 0!==e?e:function(){},s=2<arguments.length&&void 0!==i?i:function(){},a=3<arguments.length&&void 0!==n?n:function(){};G.Cache.enabled=!0;var r,c=void 0,h=void 0,d=void 0,l=void 0,u=void 0,A=void 0;for(var p in v)v.hasOwnProperty(p)&&t===v[p]&&(A=p);if(void 0!==(r=G.Cache.get(A||t)))return o&&setTimeout(function(){s({loaded:1,total:1}),o(r)},0),r;l=window.URL||window.webkitURL,u=document.createElementNS("http://www.w3.org/1999/xhtml","img"),G.Cache.add(A||t,u);function m(){l.revokeObjectURL(u.src),o(u)}if(0===t.indexOf("data:"))return u.addEventListener("load",m,!1),u.src=t,u;u.crossOrigin=void 0!==this.crossOrigin?this.crossOrigin:"",(c=new window.XMLHttpRequest).open("GET",t,!0),c.responseType="arraybuffer",c.addEventListener("error",a),c.addEventListener("progress",function(t){if(t){var e=t.loaded,i=t.total;t.lengthComputable&&s({loaded:e,total:i})}}),c.addEventListener("loadend",function(t){if(t){var e=t.currentTarget.response;h=new Uint8Array(e),d=new window.Blob([h]),u.addEventListener("load",m,!1),u.src=l.createObjectURL(d)}}),c.send(null)}},h={load:function(i,t,e,n){var o,s=1<arguments.length&&void 0!==t?t:function(){},a=e,r=n;return c.load(i,function(t){(o=new G.Texture).image=t;var e=0<i.search(/\.(jpg|jpeg)$/)||0===i.search(/^data\:image\/jpeg/);o.format=e?G.RGBFormat:G.RGBAFormat,o.needsUpdate=!0,s(o)},a,r),o}};function d(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:16777215,e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1500;this.dpr=window.devicePixelRatio;var n=this.createCanvas(),o=n.canvas,s=n.context,a=new G.SpriteMaterial({color:t,map:this.createCanvasTexture(o)});G.Sprite.call(this,a),this.canvasWidth=o.width,this.canvasHeight=o.height,this.context=s,this.color=t instanceof G.Color?t:new G.Color(t),this.autoSelect=e,this.dwellTime=i,this.rippleDuration=500,this.position.z=-10,this.center.set(.5,.5),this.scale.set(.5,.5,1),this.startTimestamp=null,this.timerId=null,this.callback=null,this.frustumCulled=!1,this.updateCanvasArcByProgress(0)}d.prototype=Object.assign(Object.create(G.Sprite.prototype),{constructor:d,setColor:function(){},createCanvasTexture:function(t){var e=new G.CanvasTexture(t);return e.minFilter=G.LinearFilter,e.magFilter=G.LinearFilter,e.generateMipmaps=!1,e},createCanvas:function(){var t=document.createElement("canvas"),e=t.getContext("2d"),i=this.dpr;return t.width=32*i,t.height=32*i,e.scale(i,i),e.shadowBlur=5,e.shadowColor="rgba(200,200,200,0.9)",{canvas:t,context:e}},updateCanvasArcByProgress:function(t){var e=this.context,i=this.canvasWidth,n=this.canvasHeight,o=this.material,s=this.dpr,a=t*Math.PI*2,r=this.color.getStyle(),c=.5*i/s,h=.5*n/s;e.clearRect(0,0,i,n),e.beginPath(),0===t?(e.arc(c,h,i/16,0,2*Math.PI),e.fillStyle=r,e.fill()):(e.arc(c,h,i/4-3,-Math.PI/2,-Math.PI/2+a),e.strokeStyle=r,e.lineWidth=3,e.stroke()),e.closePath(),o.map.needsUpdate=!0},ripple:function(){},show:function(){},hide:function(){this.visible=!1},start:function(){},end:function(){},update:function(){}});var l,u=(function(t,e){function i(){this._tweens={},this._tweensAddedDuringUpdate={}}i.prototype={getAll:function(){},removeAll:function(){},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(){},update:function(t,e){var i=Object.keys(this._tweens);if(0===i.length)return!1;for(t=void 0!==t?t:s.now();0<i.length;){this._tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++){var o=this._tweens[i[n]];o&&!1===o.update(t)&&(o._isPlaying=!1,e||delete this._tweens[i[n]])}i=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var s=new i;s.Group=i,s._nextId=0,s.nextId=function(){return s._nextId++},"undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?s.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?s.now=self.performance.now.bind(self.performance):void 0!==Date.now?s.now=Date.now:s.now=function(){return(new Date).getTime()},s.Tween=function(t,e){this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=s.Easing.Linear.None,this._interpolationFunction=s.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||s,this._id=s.nextId()},s.Tween.prototype={getId:function(){return this._id},isPlaying:function(){},to:function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},duration:function(){},start:function(t){for(var e in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==t?"string"==typeof t?s.now()+parseFloat(t):t:s.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(this._valuesStart[e]=this._object[e],this._valuesStart[e]instanceof Array==!1&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){},stopChainedTweens:function(){},group:function(){},delay:function(t){return this._delayTime=t,this},repeat:function(){},repeatDelay:function(){},yoyo:function(){},easing:function(t){return this._easingFunction=t,this},interpolation:function(){},chain:function(){},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onRepeat:function(){},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var e,i,n;if(t<this._startTime)return!0;for(e in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(t-this._startTime)/this._duration,i=0===this._duration||1<i?1:i,n=this._easingFunction(i),this._valuesEnd)if(void 0!==this._valuesStart[e]){var o=this._valuesStart[e]||0,s=this._valuesEnd[e];s instanceof Array?this._object[e]=this._interpolationFunction(s,n):("string"==typeof s&&(s="+"===s.charAt(0)||"-"===s.charAt(0)?o+parseFloat(s):parseFloat(s)),"number"==typeof s&&(this._object[e]=o+(s-o)*n))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1!==i||0<this._repeat)return!0;null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,r=this._chainedTweens.length;a<r;a++)this._chainedTweens[a].start(this._startTime+this._duration);return!1}},s.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(){},Out:function(t){return 1- --t*t*t*t},InOut:function(){}},Quintic:{In:function(){},Out:function(){},InOut:function(){}},Sinusoidal:{In:function(){},Out:function(){},InOut:function(){}},Exponential:{In:function(){},Out:function(){},InOut:function(){}},Circular:{In:function(){},Out:function(){},InOut:function(){}},Elastic:{In:function(){},Out:function(){},InOut:function(){}},Back:{In:function(){},Out:function(){},InOut:function(){}},Bounce:{In:function(){},Out:function(){},InOut:function(){}}},s.Interpolation={Linear:function(){},Bezier:function(){},CatmullRom:function(){},Utils:{Linear:function(){},Bernstein:function(){},Factorial:function(t){},CatmullRom:function(){}}},t.exports=s}(l={exports:{}},l.exports),l.exports);function A(t){t||console.warn("BAIVLENS.Widget: No container specified"),G.EventDispatcher.call(this),this.DEFAULT_TRANSITION="all 0.27s ease",this.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),this.PREVENT_EVENT_HANDLER=function(t){t.preventDefault(),t.stopPropagation()},this.container=t,this.barElement=null,this.fullscreenElement=null,this.videoElement=null,this.settingElement=null,this.mainMenu=null,this.activeMainItem=null,this.activeSubMenu=null,this.mask=null}function p(t,e){G.Mesh.call(this,t,e),this.type="panorama",this.ImageQualityLow=1,this.ImageQualityFair=2,this.ImageQualityMedium=3,this.ImageQualityHigh=4,this.ImageQualitySuperHigh=5,this.animationDuration=1e3,this.defaultInfospotSize=350,this.container=void 0,this.loaded=!1,this.linkedSpots=[],this.isInfospotVisible=!1,this.linkingImageURL=void 0,this.linkingImageScale=void 0,this.material.side=G.BackSide,this.material.opacity=0,this.scale.x*=-1,this.renderOrder=-1,this.active=!1,this.infospotAnimation=new u.Tween(this).to({},this.animationDuration/2),this.addEventListener("load",this.fadeIn.bind(this)),this.addEventListener("panolens-container",this.setContainer.bind(this)),this.addEventListener("click",this.onClick.bind(this)),this.setupTransitions()}function m(t,e,i){var n=this.__geometry=e||new G.SphereBufferGeometry(5e3,60,40),o=this.__material=i||new G.MeshBasicMaterial({opacity:0,transparent:!0});p.call(this,n,o),this.src=t,this.radius=5e3}A.prototype=Object.assign(Object.create(G.EventDispatcher.prototype),{constructor:A,addControlBar:function(){if(this.container){var t,e,i;(t=document.createElement("div")).id="panolens_toolbar",t.style.width="48px",t.style.height="44px",t.style.float="left",t.style.position="absolute",t.style.top="49px",t.style.right="39px",t.style.zIndex="99999999",t.style.paddingRight="8px",t.style.transform=t.style.webkitTransform=t.style.msTransform="translateY(-100%)",t.style.transition=this.DEFAULT_TRANSITION,t.style.pointerEvents="none",t.isHidden=!1,t.toggle=function(){t.isHidden=!t.isHidden,e=t.isHidden?"translateY(0)":"translateY(-100%)",i=t.isHidden?0:1,t.style.transform=t.style.webkitTransform=t.style.msTransform=e,t.style.opacity=i};var n=this.createDefaultMenu();this.mainMenu=this.createMainMenu(n),t.appendChild(this.mainMenu);var o=this.createMask();this.mask=o,this.container.appendChild(o),t.dispose=function(){},this.container.appendChild(t),this.mask.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener(this.TOUCH_ENABLED?"touchend":"click",function(t){},!1),this.addEventListener("control-bar-toggle",t.toggle),this.barElement=t}else console.warn("Widget container not set")},createDefaultMenu:function(){var t;return t=function(){return function(){}},[{title:"Control",subMenu:[{title:this.TOUCH_ENABLED?"Touch":"Mouse",handler:t()},{title:"Sensor",handler:t()}]},{title:"Mode",subMenu:[{title:"Normal",handler:t()},{title:"Cardboard",handler:t()},{title:"Stereoscopic",handler:t()}]}]},addControlButton:function(t){var e=void 0;switch(t){case"fullscreen":e=this.createFullscreenButton(),this.fullscreenElement=e;break;default:return}e&&this.barElement.appendChild(e)},createMask:function(){var t=document.createElement("div");return t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.width="100%",t.style.height="100%",t.style.background="transparent",t.style.display="none",t.show=function(){},t.hide=function(){},t},createSettingButton:function(){var t=void 0;return(t=this.createCustomItem({style:{backgroundImage:'url("'+v.Setting+'")',webkitTransition:this.DEFAULT_TRANSITION,transition:this.DEFAULT_TRANSITION},onTap:function(t){}})).activate=function(){},t.deactivate=function(){},t.activated=!1,t},createFullscreenButton:function(){var t=this,e=void 0,i=!1,n=!0,o=this.container;if(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)return document.addEventListener("fullscreenchange",s,!1),document.addEventListener("webkitfullscreenchange",s,!1),document.addEventListener("mozfullscreenchange",s,!1),document.addEventListener("MSFullscreenChange",s,!1),e=this.createCustomItem({style:{backgroundImage:'url("'+v.FullscreenEnter+'")'},onTap:function(t){t.preventDefault(),t.stopPropagation(),n=!1,i=i?(document.exitFullscreen&&document.exitFullscreen(),document.msExitFullscreen&&document.msExitFullscreen(),document.mozCancelFullScreen&&document.mozCancelFullScreen(),document.webkitExitFullscreen&&document.webkitExitFullscreen(),!1):(o.requestFullscreen&&o.requestFullscreen(),o.msRequestFullscreen&&o.msRequestFullscreen(),o.mozRequestFullScreen&&o.mozRequestFullScreen(),o.webkitRequestFullscreen&&o.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),!0),this.style.backgroundImage=i?'url("'+v.FullscreenLeave+'")':'url("'+v.FullscreenEnter+'")'}});function s(){n&&(i=!i,e.style.backgroundImage=i?'url("'+v.FullscreenLeave+'")':'url("'+v.FullscreenEnter+'")'),t.dispatchEvent({type:"panolens-viewer-handler",method:"onWindowResize"}),n=!0}},createVideoControl:function(){var t=document.createElement("span");return t.style.display="none",t.show=function(){},t.hide=function(){},t.controlButton=this.createVideoControlButton(),t.seekBar=this.createVideoControlSeekbar(),t.appendChild(t.controlButton),t.appendChild(t.seekBar),t.dispose=function(){},this.addEventListener("video-control-show",t.show),this.addEventListener("video-control-hide",t.hide),t},createVideoControlButton:function(){var t=this.createCustomItem({style:{float:"left",backgroundImage:'url("'+v.VideoPlay+'")'},onTap:function(t){}});return t.paused=!0,t.update=function(t){},t},createVideoControlSeekbar:function(){var t=void 0,e=void 0,i=void 0;function n(t){}return(e=document.createElement("div")).style.width="0%",e.style.height="100%",e.style.backgroundColor="#fff",(i=document.createElement("div")).style.float="right",i.style.width="14px",i.style.height="14px",i.style.transform="translate(7px, -5px)",i.style.borderRadius="50%",i.style.backgroundColor="#ddd",i.addEventListener("mousedown",n,{passive:!0}),i.addEventListener("touchstart",n,{passive:!0}),e.appendChild(i),(t=this.createCustomItem({style:{float:"left",width:"30%",height:"4px",marginTop:"20px",backgroundColor:"rgba(188,188,188,0.8)"},onTap:function(t){},onDispose:function(){}})).appendChild(e),t.setProgress=function(t){},this.addEventListener("video-update",function(t){}),t.progressElement=e,t.progressElementControl=i,t},createMenuItem:function(t){var i=this,e=document.createElement("a");return e.textContent=t,e.style.display="block",e.style.padding="10px",e.style.textDecoration="none",e.style.cursor="pointer",e.style.pointerEvents="auto",e.style.transition=this.DEFAULT_TRANSITION,e.slide=function(t){this.style.transform="translateX("+(t?"":"-")+"100%)"},e.unslide=function(){this.style.transform="translateX(0)"},e.setIcon=function(t){this.icon&&(this.icon.style.backgroundImage="url("+t+")")},e.setSelectionTitle=function(t){this.selection&&(this.selection.textContent=t)},e.addSelection=function(t){var e=document.createElement("span");return e.style.fontSize="13px",e.style.fontWeight="300",e.style.float="right",this.selection=e,this.setSelectionTitle(t),this.appendChild(e),this},e.addIcon=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:v.ChevronRight,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=document.createElement("span");return n.style.float=e?"left":"right",n.style.width="17px",n.style.height="17px",n.style["margin"+(e?"Right":"Left")]="12px",n.style.backgroundSize="cover",i&&(n.style.transform="rotateZ(180deg)"),this.icon=n,this.setIcon(t),this.appendChild(n),this},e.addSubMenu=function(t,e){return this.subMenu=i.createSubMenu(t,e),this},e.addEventListener("mouseenter",function(){this.style.backgroundColor="#e0e0e0"},!1),e.addEventListener("mouseleave",function(){},!1),e},createMenuItemHeader:function(t){var e=this.createMenuItem(t);return e.style.borderBottom="1px solid #333",e.style.paddingBottom="15px",e},createMainMenu:function(t){var e=this.createMenu();function i(t){}e._width=200,e.changeSize(e._width);for(var n=0;n<t.length;n++){var o=e.addItem(t[n].title);if(o.style.paddingLeft="20px",o.addIcon().addEventListener(this.TOUCH_ENABLED?"touchend":"click",i,!1),t[n].subMenu&&0<t[n].subMenu.length){var s=t[n].subMenu[0].title;o.addSelection(s).addSubMenu(t[n].title,t[n].subMenu)}}return e},createSubMenu:function(t,e){var i=this.createMenu();function n(t){}i.items=e,i.activeItem=null,i.addHeader(t).addIcon(void 0,!0,!0).addEventListener(this.TOUCH_ENABLED?"touchend":"click",n,!1);for(var o=0;o<e.length;o++){var s=i.addItem(e[o].title);s.style.fontWeight=300,s.handler=e[o].handler,s.addIcon(" ",!0),s.addEventListener(this.TOUCH_ENABLED?"touchend":"click",n,!1),i.activeItem||i.setActiveItem(s)}return i.slideAll(!0),i},createMenu:function(){var i=this,n=document.createElement("span"),t=n.style;return t.padding="5px 0",t.position="fixed",t.bottom="100%",t.right="14px",t.backgroundColor="#fafafa",t.fontFamily="Helvetica Neue",t.fontSize="14px",t.visibility="hidden",t.opacity=0,t.boxShadow="0 0 12pt rgba(0,0,0,0.25)",t.borderRadius="2px",t.overflow="hidden",t.willChange="width, height, opacity",t.pointerEvents="auto",t.transition=this.DEFAULT_TRANSITION,n.visible=!1,n.changeSize=function(t,e){t&&(this.style.width=t+"px"),e&&(this.style.height=e+"px")},n.show=function(){},n.hide=function(){},n.toggle=function(){},n.slideAll=function(t){for(var e=0;e<n.children.length;e++)n.children[e].slide&&n.children[e].slide(t)},n.unslideAll=function(){},n.addHeader=function(t){var e=i.createMenuItemHeader(t);return e.type="header",this.appendChild(e),e},n.addItem=function(t){var e=i.createMenuItem(t);return e.type="item",this.appendChild(e),e},n.setActiveItem=function(t){this.activeItem&&this.activeItem.setIcon(" "),t.setIcon(v.Check),this.activeItem=t},n.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0),n.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,!0),n.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0),n},createCustomItem:function(t){var e=0<arguments.length&&void 0!==t?t:{},i=e.element||document.createElement("span");e.onDispose;return i.style.cursor="pointer",i.style.float="right",i.style.width="44px",i.style.height="100%",i.style.backgroundSize="60%",i.style.backgroundRepeat="no-repeat",i.style.backgroundPosition="center",i.style.webkitUserSelect=i.style.MozUserSelect=i.style.userSelect="none",i.style.position="relative",i.style.pointerEvents="auto",i.addEventListener(this.TOUCH_ENABLED?"touchstart":"mouseenter",function(){i.style.filter=i.style.webkitFilter="drop-shadow(0 0 5px rgba(255,255,255,1))"},{passive:!0}),i.addEventListener(this.TOUCH_ENABLED?"touchend":"mouseleave",function(){i.style.filter=i.style.webkitFilter=""},{passive:!0}),this.mergeStyleOptions(i,e.style),e.onTap&&i.addEventListener(this.TOUCH_ENABLED?"touchend":"click",e.onTap,!1),i.dispose=function(){},i},mergeStyleOptions:function(t,e){var i=1<arguments.length&&void 0!==e?e:{};for(var n in i)i.hasOwnProperty(n)&&(t.style[n]=i[n]);return t},dispose:function(){}}),p.prototype=Object.assign(Object.create(G.Mesh.prototype),{constructor:p,add:function(){},load:function(){},onClick:function(){},setContainer:function(t){var e=void 0;t instanceof HTMLElement?e=t:t&&t.container&&(e=t.container),e&&(this.children.forEach(function(t){}),this.container=e)},onLoad:function(){this.loaded=!0,this.dispatchEvent({type:"load"})},onProgress:function(){},onError:function(){},getZoomLevel:function(){},updateTexture:function(t){this.material.map=t,this.material.needsUpdate=!0},toggleInfospotVisibility:function(t,e){e=void 0!==e?e:0;var i=void 0!==t?t:!this.isInfospotVisible;this.traverse(function(t){}),this.isInfospotVisible=i,this.infospotAnimation.onComplete(function(){this.dispatchEvent({type:"infospot-animation-complete",visible:i})}.bind(this)).delay(e).start()},setLinkingImage:function(t,e){this.linkingImageURL=t,this.linkingImageScale=e},link:function(){},reset:function(){this.children.length=0},setupTransitions:function(){this.fadeInAnimation=new u.Tween(this.material).easing(u.Easing.Quartic.Out).onStart(function(){this.visible=!0,this.dispatchEvent({type:"enter-fade-start"})}.bind(this)),this.fadeOutAnimation=new u.Tween(this.material).easing(u.Easing.Quartic.Out).onComplete(function(){this.visible=!1,this.dispatchEvent({type:"leave-complete"})}.bind(this)),this.enterTransition=new u.Tween(this).easing(u.Easing.Quartic.Out).onComplete(function(){this.dispatchEvent({type:"enter-complete"})}.bind(this)).start(),this.leaveTransition=new u.Tween(this).easing(u.Easing.Quartic.Out)},onFadeAnimationUpdate:function(){var t=this.material.opacity,e=this.material.uniforms;e&&e.opacity&&(e.opacity.value=t)},fadeIn:function(t){t=0<=t?t:this.animationDuration,this.fadeOutAnimation.stop(),this.fadeInAnimation.to({opacity:1},t).onUpdate(this.onFadeAnimationUpdate.bind(this)).onComplete(function(){this.toggleInfospotVisibility(!0,t/2),this.dispatchEvent({type:"enter-fade-complete"})}.bind(this)).start()},fadeOut:function(){},onEnter:function(){var t=this.animationDuration;this.leaveTransition.stop(),this.enterTransition.to({},t).onStart(function(){this.dispatchEvent({type:"enter-start"}),this.loaded?this.fadeIn(t):this.load()}.bind(this)).start(),this.dispatchEvent({type:"enter"}),this.children.forEach(function(t){t.dispatchEvent({type:"panorama-enter"})}),this.active=!0},onLeave:function(){},dispose:function(){this.infospotAnimation.stop(),this.fadeInAnimation.stop(),this.fadeOutAnimation.stop(),this.enterTransition.stop(),this.leaveTransition.stop(),this.dispatchEvent({type:"panolens-viewer-handler",method:"onPanoramaDispose",data:this}),function t(e){for(var i=e.geometry,n=e.material,o=e.children.length-1;0<=o;o--)t(e.children[o]),e.remove(e.children[o]);i&&(i.dispose(),e.geometry=null),n&&(n.dispose(),e.material=null)}(this),this.parent&&this.parent.remove(this)}}),m.prototype=Object.assign(Object.create(p.prototype),{constructor:m,load:function(t){(t=t||this.src)?"string"==typeof t?h.load(t,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this)):t instanceof HTMLImageElement&&this.onLoad(new G.Texture(t)):console.warn("Image source undefined")},onLoad:function(t){t.minFilter=t.magFilter=G.LinearFilter,t.needsUpdate=!0,this.updateTexture(t),window.requestAnimationFrame(p.prototype.onLoad.bind(this))},reset:function(){p.prototype.reset.call(this)},dispose:function(){var t;this.material&&(t=this.material.map),G.Cache.remove(this.src),t&&t.dispose(),p.prototype.dispose.call(this)}});new G.Texture,new G.Matrix4,["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform float resolution;","uniform mat4 transform;","uniform float zoom;","uniform float opacity;","varying vec2 vUv;","const float PI = 3.141592653589793;","void main(){","vec2 position = -1.0 +  2.0 * vUv;","position *= vec2( zoom * resolution, zoom * 0.5 );","float x2y2 = position.x * position.x + position.y * position.y;","vec3 sphere_pnt = vec3( 2. * position, x2y2 - 1. ) / ( x2y2 + 1. );","sphere_pnt = vec3( transform * vec4( sphere_pnt, 1.0 ) );","vec2 sampleUV = vec2(","(atan(sphere_pnt.y, sphere_pnt.x) / PI + 1.0) * 0.5,","(asin(sphere_pnt.z) / PI + 0.5)",");","gl_FragColor = texture2D( tDiffuse, sampleUV );","gl_FragColor.a *= opacity;","}"].join("\n");function g(t,e){this.object=t,this.domElement=void 0!==e?e:document,this.frameId=null,this.enabled=!0,this.target=new G.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=-.15,this.noPan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.momentumDampingFactor=.9,this.momentumScalingFactor=-.005,this.momentumKeydownFactor=20,this.minFov=30,this.maxFov=120,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:G.MOUSE.LEFT,ZOOM:G.MOUSE.MIDDLE,PAN:G.MOUSE.RIGHT};var s,i,n,o,a,r=this,c=new G.Vector2,h=new G.Vector2,d=new G.Vector2,l=new G.Vector2,u=new G.Vector2,A=new G.Vector2,p=new G.Vector3,m=new G.Vector3,v=new G.Vector2,g=new G.Vector2,E=new G.Vector2,f=0,b=0,y=0,w=0,I=1,R=new G.Vector3,M=new G.Vector3,C=new G.Quaternion,L=0,T=0,O=!1,S={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},D=S.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var N=(new G.Quaternion).setFromUnitVectors(t.up,new G.Vector3(0,1,0)),j=N.clone().inverse(),k={type:"change"},U={type:"start"},x={type:"end"};function B(t){if(L=T=0,(O=!1)!==r.enabled){if(t.preventDefault(),t.button===r.mouseButtons.ORBIT){if(!0===r.noRotate)return;D=S.ROTATE,c.set(t.clientX,t.clientY)}else if(t.button===r.mouseButtons.ZOOM){if(!0===r.noZoom)return;D=S.DOLLY,v.set(t.clientX,t.clientY)}else if(t.button===r.mouseButtons.PAN){if(!0===r.noPan)return;D=S.PAN,l.set(t.clientX,t.clientY)}D!==S.NONE&&(document.addEventListener("mousemove",P,!1),document.addEventListener("mouseup",H,!1),r.dispatchEvent(U)),r.update()}}function P(t){if(!1!==r.enabled){t.preventDefault();var e=r.domElement===document?r.domElement.body:r.domElement;if(D===S.ROTATE){if(!0===r.noRotate)return;h.set(t.clientX,t.clientY),d.subVectors(h,c),r.rotateLeft(2*Math.PI*d.x/e.clientWidth*r.rotateSpeed),r.rotateUp(2*Math.PI*d.y/e.clientHeight*r.rotateSpeed),c.copy(h),s&&(L=t.clientX-s.clientX,T=t.clientY-s.clientY),s=t}else D===S.DOLLY||S.PAN;D!==S.NONE&&r.update()}}function H(){!(O=!(s=void 0))!==r.enabled&&(document.removeEventListener("mousemove",P,!1),document.removeEventListener("mouseup",H,!1),r.dispatchEvent(x),D=S.NONE)}function V(t){if(!1!==r.enabled&&!0!==r.noZoom&&D===S.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),0<e?(r.object.fov=r.object.fov<r.maxFov?r.object.fov+1:r.maxFov,r.object.updateProjectionMatrix()):e<0&&(r.object.fov=r.object.fov>r.minFov?r.object.fov-1:r.minFov,r.object.updateProjectionMatrix()),r.update(),r.dispatchEvent(k),r.dispatchEvent(U),r.dispatchEvent(x)}}function F(t){}function z(t){if(!1!==r.enabled&&!0!==r.noKeys&&!0!==r.noRotate){switch(t.keyCode){case r.keys.UP:i=!0;break;case r.keys.BOTTOM:n=!0;break;case r.keys.LEFT:o=!0;break;case r.keys.RIGHT:a=!0}(i||n||o||a)&&(O=!0,i&&(T=-r.rotateSpeed*r.momentumKeydownFactor),n&&(T=r.rotateSpeed*r.momentumKeydownFactor),o&&(L=-r.rotateSpeed*r.momentumKeydownFactor),a&&(L=r.rotateSpeed*r.momentumKeydownFactor))}}function _(t){if(L=T=0,(O=!1)!==r.enabled){switch(t.touches.length){case 1:if(!0===r.noRotate)return;D=S.TOUCH_ROTATE,c.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===r.noZoom)return;D=S.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);v.set(0,n);break;case 3:if(!0===r.noPan)return;D=S.TOUCH_PAN,l.set(t.touches[0].pageX,t.touches[0].pageY);break;default:D=S.NONE}D!==S.NONE&&r.dispatchEvent(U)}}function Z(t){if(!1!==r.enabled){t.preventDefault(),t.stopPropagation();var e=r.domElement===document?r.domElement.body:r.domElement;switch(t.touches.length){case 1:if(!0===r.noRotate)return;if(D!==S.TOUCH_ROTATE)return;h.set(t.touches[0].pageX,t.touches[0].pageY),d.subVectors(h,c),r.rotateLeft(2*Math.PI*d.x/e.clientWidth*r.rotateSpeed),r.rotateUp(2*Math.PI*d.y/e.clientHeight*r.rotateSpeed),c.copy(h),s&&(L=t.touches[0].pageX-s.pageX,T=t.touches[0].pageY-s.pageY),s={pageX:t.touches[0].pageX,pageY:t.touches[0].pageY},r.update();break;case 2:if(!0===r.noZoom)return;if(D!==S.TOUCH_DOLLY)return;var i=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,o=Math.sqrt(i*i+n*n);g.set(0,o),E.subVectors(g,v),E.y<0?(r.object.fov=r.object.fov<r.maxFov?r.object.fov+1:r.maxFov,r.object.updateProjectionMatrix()):0<E.y&&(r.object.fov=r.object.fov>r.minFov?r.object.fov-1:r.minFov,r.object.updateProjectionMatrix()),v.copy(g),r.update(),r.dispatchEvent(k);break;case 3:if(!0===r.noPan)return;if(D!==S.TOUCH_PAN)return;u.set(t.touches[0].pageX,t.touches[0].pageY),A.subVectors(u,l),r.pan(A.x,A.y),l.copy(u),r.update();break;default:D=S.NONE}}}function Q(){!(O=!(s=void 0))!==r.enabled&&(r.dispatchEvent(x),D=S.NONE)}this.setLastQuaternion=function(t){C.copy(t),r.object.quaternion.copy(t)},this.getLastPosition=function(){return M},this.rotateLeft=function(t){void 0===t&&(t=void 0),w-=t},this.rotateUp=function(t){void 0===t&&(t=void 0),y-=t},this.panLeft=function(t){var e=this.object.matrix.elements;p.set(e[0],e[1],e[2]),p.multiplyScalar(-t),R.add(p)},this.panUp=function(t){var e=this.object.matrix.elements;p.set(e[4],e[5],e[6]),p.multiplyScalar(t),R.add(p)},this.pan=function(t,e){},this.momentum=function(){O&&(Math.abs(L)<1e-4&&Math.abs(T)<1e-4?O=!1:(T*=this.momentumDampingFactor,L*=this.momentumDampingFactor,w-=this.momentumScalingFactor*L,y-=this.momentumScalingFactor*T))},this.dollyIn=function(t){},this.dollyOut=function(t){},this.update=function(t){var e=this.object.position;m.copy(e).sub(this.target),m.applyQuaternion(N),f=Math.atan2(m.x,m.z),b=Math.atan2(Math.sqrt(m.x*m.x+m.z*m.z),m.y),this.autoRotate&&D===S.NONE&&this.rotateLeft(void 0),this.momentum(),f+=w,b+=y,f=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,f)),b=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,b)),b=Math.max(1e-7,Math.min(Math.PI-1e-7,b));var i=m.length()*I;i=Math.max(this.minDistance,Math.min(this.maxDistance,i)),this.target.add(R),m.x=i*Math.sin(b)*Math.sin(f),m.y=i*Math.cos(b),m.z=i*Math.sin(b)*Math.cos(f),m.applyQuaternion(j),e.copy(this.target).add(m),this.object.lookAt(this.target),y=w=0,I=1,R.set(0,0,0),(1e-7<M.distanceToSquared(this.object.position)||1e-7<8*(1-C.dot(this.object.quaternion)))&&(!0!==t&&this.dispatchEvent(k),M.copy(this.object.position),C.copy(this.object.quaternion))},this.reset=function(){},this.getPolarAngle=function(){},this.getAzimuthalAngle=function(){},this.dispose=function(){this.domElement.removeEventListener("mousedown",B),this.domElement.removeEventListener("mousewheel",V),this.domElement.removeEventListener("DOMMouseScroll",V),this.domElement.removeEventListener("touchstart",_),this.domElement.removeEventListener("touchend",Q),this.domElement.removeEventListener("touchmove",Z),window.removeEventListener("keyup",F),window.removeEventListener("keydown",z)},this.domElement.addEventListener("mousedown",B,{passive:!1}),this.domElement.addEventListener("mousewheel",V,{passive:!1}),this.domElement.addEventListener("DOMMouseScroll",V,{passive:!1}),this.domElement.addEventListener("touchstart",_,{passive:!1}),this.domElement.addEventListener("touchend",Q,{passive:!1}),this.domElement.addEventListener("touchmove",Z,{passive:!1}),window.addEventListener("keyup",F,{passive:!1}),window.addEventListener("keydown",z,{passive:!1}),this.update()}function E(t,e){var g=this,E={type:"change"},i=0,f=0,n=0,o=0;this.camera=t,this.camera.rotation.reorder("YXZ"),this.domElement=void 0!==e?e:document,this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;function s(t){g.deviceOrientation=t}function a(){g.screenOrientation=window.orientation||0}function r(t){t.preventDefault(),t.stopPropagation(),n=t.touches[0].pageX,o=t.touches[0].pageY}function c(t){t.preventDefault(),t.stopPropagation(),i+=G.Math.degToRad((t.touches[0].pageX-n)/4),f+=G.Math.degToRad((o-t.touches[0].pageY)/4),g.updateAlphaOffsetAngle(i),n=t.touches[0].pageX,o=t.touches[0].pageY}this.connect=function(){a(),window.addEventListener("orientationchange",a,{passive:!0}),window.addEventListener("deviceorientation",s,{passive:!0}),window.addEventListener("deviceorientation",this.update.bind(this),{passive:!0}),g.domElement.addEventListener("touchstart",r,{passive:!1}),g.domElement.addEventListener("touchmove",c,{passive:!1}),g.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",a,!1),window.removeEventListener("deviceorientation",s,!1),window.removeEventListener("deviceorientation",this.update.bind(this),!1),g.domElement.removeEventListener("touchstart",r,!1),g.domElement.removeEventListener("touchmove",c,!1),g.enabled=!1},this.update=function(t){if(!1!==g.enabled){var e,i,n,o,s,a,r,c,h,d,l,u,A=g.deviceOrientation.alpha?G.Math.degToRad(g.deviceOrientation.alpha)+g.alphaOffsetAngle:0,p=g.deviceOrientation.beta?G.Math.degToRad(g.deviceOrientation.beta):0,m=g.deviceOrientation.gamma?G.Math.degToRad(g.deviceOrientation.gamma):0,v=g.screenOrientation?G.Math.degToRad(g.screenOrientation):0;e=g.camera.quaternion,i=A,n=p,o=m,s=v,r=new G.Vector3(0,0,1),c=new G.Euler,h=new G.Quaternion,d=new G.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),l=new G.Quaternion,u=new G.Quaternion,0==g.screenOrientation?(a=new G.Vector3(1,0,0),l.setFromAxisAngle(a,-f)):180==g.screenOrientation?(a=new G.Vector3(1,0,0),l.setFromAxisAngle(a,f)):90==g.screenOrientation?(a=new G.Vector3(0,1,0),l.setFromAxisAngle(a,f)):-90==g.screenOrientation&&(a=new G.Vector3(0,1,0),l.setFromAxisAngle(a,-f)),d.multiply(l),d.multiply(u),c.set(n,i,-o,"YXZ"),e.setFromEuler(c),e.multiply(d),e.multiply(h.setFromAxisAngle(r,-s)),g.alpha=A,!0!==t&&g.dispatchEvent(E)}},this.updateAlphaOffsetAngle=function(t){this.alphaOffsetAngle=t,this.update()},this.dispose=function(){this.disconnect()},this.connect()}function f(o){var s=new G.OrthographicCamera(-1,1,1,-1,0,1),a=new G.Scene,r=new G.StereoCamera;r.aspect=.5;var t={minFilter:G.LinearFilter,magFilter:G.NearestFilter,format:G.RGBAFormat},c=new G.WebGLRenderTarget(512,512,t);c.scissorTest=!0,c.texture.generateMipmaps=!1;var e=new G.Vector2(.441,.156),i=new G.PlaneBufferGeometry(1,1,10,20).removeAttribute("normal").toNonIndexed(),n=i.attributes.position.array,h=i.attributes.uv.array;i.attributes.position.count*=2,i.attributes.uv.count*=2;var d=new Float32Array(2*n.length);d.set(n),d.set(n,n.length);var l=new Float32Array(2*h.length);l.set(h),l.set(h,h.length);for(var u=new G.Vector2,A=n.length/3,p=0,m=d.length/3;p<m;p++){u.x=d[3*p+0],u.y=d[3*p+1];var v=u.dot(u),g=1.5+(e.x+e.y*v)*v,E=p<A?0:1;d[3*p+0]=u.x/g*1.5-.5+E,d[3*p+1]=u.y/g*3,l[2*p]=.5*(l[2*p]+E)}i.attributes.position.array=d,i.attributes.uv.array=l;var f=new G.MeshBasicMaterial({map:c.texture}),b=new G.Mesh(i,f);a.add(b),this.setSize=function(t,e){o.setSize(t,e);var i=o.getPixelRatio();c.setSize(t*i,e*i)},this.render=function(t,e){t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),r.update(e);var i=c.width/2,n=c.height;o.autoClear&&o.clear(),c.scissor.set(0,0,i,n),c.viewport.set(0,0,i,n),o.setRenderTarget(c),o.render(t,r.cameraL),o.clearDepth(),c.scissor.set(i,0,i,n),c.viewport.set(i,0,i,n),o.setRenderTarget(c),o.render(t,r.cameraR),o.clearDepth(),o.setRenderTarget(null),o.render(a,s)}}g.prototype=Object.assign(Object.create(G.EventDispatcher.prototype),{constructor:g}),E.prototype=Object.assign(Object.create(G.EventDispatcher.prototype),{constructor:E});function b(i){var n=new G.StereoCamera;n.aspect=.5;var o=new G.Vector2;this.setEyeSeparation=function(t){n.eyeSep=t},this.setSize=function(t,e){i.setSize(t,e)},this.render=function(t,e){t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),n.update(e),i.getSize(o),i.autoClear&&i.clear(),i.setScissorTest(!0),i.setScissor(0,0,o.width/2,o.height),i.setViewport(0,0,o.width/2,o.height),i.render(t,n.cameraL),i.setScissor(o.width/2,0,o.width/2,o.height),i.setViewport(o.width/2,0,o.width/2,o.height),i.render(t,n.cameraR),i.setScissorTest(!1)}}function y(t){var e=void 0;(t=t||{}).controlBar=void 0===t.controlBar||t.controlBar,t.autoHideControlBar=void 0!==t.autoHideControlBar&&t.autoHideControlBar,t.autoHideInfospot=void 0===t.autoHideInfospot||t.autoHideInfospot,t.horizontalView=void 0!==t.horizontalView&&t.horizontalView,t.clickTolerance=t.clickTolerance||10,t.cameraFov=t.cameraFov||60,t.reverseDragging=t.reverseDragging||!1,t.enableReticle=t.enableReticle||!1,t.dwellTime=t.dwellTime||1500,t.autoReticleSelect=void 0===t.autoReticleSelect||t.autoReticleSelect,t.viewIndicator=void 0!==t.viewIndicator&&t.viewIndicator,t.indicatorSize=t.indicatorSize||30,t.output=t.output?t.output:"none",t.autoRotate=t.autoRotate||!1,t.autoRotateSpeed=t.autoRotateSpeed||2,t.autoRotateActivationDuration=t.autoRotateActivationDuration||5e3,(this.options=t).container?((e=t.container)._width=e.clientWidth,e._height=e.clientHeight):((e=document.createElement("div")).classList.add("panolens-container"),e.style.width="100%",e.style.height="100%",e._width=window.innerWidth,e._height=window.innerHeight,document.body.appendChild(e)),this.container=e,this.camera=t.camera||new G.PerspectiveCamera(this.options.cameraFov,this.container.clientWidth/this.container.clientHeight,1,1e4),this.scene=t.scene||new G.Scene,this.renderer=t.renderer||new G.WebGLRenderer({alpha:!0,antialias:!1}),this.sceneReticle=new G.Scene,this.viewIndicatorSize=this.options.indicatorSize,this.reticle={},this.tempEnableReticle=this.options.enableReticle,this.mode=r.NORMAL,this.panorama=null,this.widget=null,this.hoverObject=null,this.infospot=null,this.pressEntityObject=null,this.pressObject=null,this.raycaster=new G.Raycaster,this.raycasterPoint=new G.Vector2,this.userMouse=new G.Vector2,this.updateCallbacks=[],this.requestAnimationId=null,this.cameraFrustum=new G.Frustum,this.cameraViewProjectionMatrix=new G.Matrix4,this.autoRotateRequestId=null,this.outputDivElement=null,this.touchSupported="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,this.HANDLER_MOUSE_DOWN=this.onMouseDown.bind(this),this.HANDLER_MOUSE_UP=this.onMouseUp.bind(this),this.HANDLER_MOUSE_MOVE=this.onMouseMove.bind(this),this.HANDLER_WINDOW_RESIZE=this.onWindowResize.bind(this),this.HANDLER_KEY_DOWN=this.onKeyDown.bind(this),this.HANDLER_KEY_UP=this.onKeyUp.bind(this),this.HANDLER_TAP=this.onTap.bind(this,{clientX:this.container.clientWidth/2,clientY:this.container.clientHeight/2}),this.OUTPUT_INFOSPOT=!1,this.tweenLeftAnimation=new u.Tween,this.tweenUpAnimation=new u.Tween,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setClearColor(0,0),this.renderer.autoClear=!1,this.renderer.domElement.classList.add("panolens-canvas"),this.renderer.domElement.style.display="block",this.container.style.backgroundColor="#000",this.container.appendChild(this.renderer.domElement),this.OrbitControls=new g(this.camera,this.container),this.OrbitControls.id="orbit",this.OrbitControls.minDistance=1,this.OrbitControls.noPan=!0,this.OrbitControls.autoRotate=this.options.autoRotate,this.OrbitControls.autoRotateSpeed=this.options.autoRotateSpeed,this.DeviceOrientationControls=new E(this.camera,this.container),this.DeviceOrientationControls.id="device-orientation",this.DeviceOrientationControls.enabled=!1,this.camera.position.z=1,this.options.passiveRendering&&console.warn("passiveRendering is now deprecated"),this.controls=[this.OrbitControls,this.DeviceOrientationControls],this.control=this.OrbitControls,this.CardboardEffect=new f(this.renderer),this.CardboardEffect.setSize(this.container.clientWidth,this.container.clientHeight),this.StereoEffect=new b(this.renderer),this.StereoEffect.setSize(this.container.clientWidth,this.container.clientHeight),this.effect=this.CardboardEffect,this.addReticle(),this.options.horizontalView&&(this.OrbitControls.minPolarAngle=Math.PI/2,this.OrbitControls.maxPolarAngle=Math.PI/2),!1!==this.options.controlBar&&this.addDefaultControlBar(this.options.controlButtons),this.options.viewIndicator&&this.addViewIndicator(),this.options.reverseDragging&&this.reverseDraggingDirection(),this.options.enableReticle?this.enableReticleControl():this.registerMouseAndTouchEvents(),"overlay"===this.options.output&&this.addOutputElement(),this.registerEventListeners(),this.animate.call(this)}y.prototype=Object.assign(Object.create(G.EventDispatcher.prototype),{constructor:y,add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}this.scene.add(t),t.addEventListener&&t.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),t instanceof p&&t.dispatchEvent&&t.dispatchEvent({type:"panolens-container",container:this.container}),"panorama"===t.type&&(this.addPanoramaEventListener(t),this.panorama||this.setPanorama(t))},remove:function(t){t.removeEventListener&&t.removeEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),this.scene.remove(t)},addDefaultControlBar:function(t){if(t)if(this.widget)console.warn("Default control bar exists");else{var e=new A(this.container);e.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),e.addControlBar(),t.forEach(function(t){e.addControlButton(t)}),this.widget=e}},setPanorama:function(e){var i=this.panorama;if("panorama"===e.type&&i!==e){e.addEventListener("enter-fade-start",function t(){i&&i.onLeave(),e.removeEventListener("enter-fade-start",t)}),(this.panorama=e).onEnter()}},eventHandler:function(t){t.method&&this[t.method]&&this[t.method](t.data)},dispatchEventToChildren:function(e){this.scene.traverse(function(t){t.dispatchEvent&&t.dispatchEvent(e)})},activateWidgetItem:function(){},enableEffect:function(){},disableEffect:function(){},enableReticleControl:function(){},disableReticleControl:function(){},enableAutoRate:function(){},disableAutoRate:function(){clearTimeout(this.autoRotateRequestId),this.options.autoRotate=!1,this.OrbitControls.autoRotate=!1},toggleVideoPlay:function(){},setVideoCurrentTime:function(){},onVideoUpdate:function(){},addUpdateCallback:function(){},removeUpdateCallback:function(){},showVideoWidget:function(){},hideVideoWidget:function(){},updateVideoPlayButton:function(){},addPanoramaEventListener:function(t){t.addEventListener("enter-fade-start",this.setCameraControl.bind(this))},setCameraControl:function(){this.OrbitControls.target.copy(this.panorama.position)},getControl:function(){},getScene:function(){},getCamera:function(){},getRenderer:function(){},getContainer:function(){return this.container},getControlId:function(){},getNextControlId:function(){},getNextControlIndex:function(){},setCameraFov:function(){},enableControl:function(){},disableControl:function(){},toggleNextControl:function(){},getScreenVector:function(){},checkSpriteInViewport:function(){},reverseDraggingDirection:function(){},addReticle:function(){this.reticle=new d(16777215,!0,this.options.dwellTime),this.reticle.hide(),this.camera.add(this.reticle),this.sceneReticle.add(this.camera)},tweenControlCenter:function(){},tweenControlCenterByObject:function(){},onWindowResize:function(t,e){var i=void 0,n=void 0,o=this.container.classList.contains("panolens-container")||this.container.isFullscreen;if(void 0!==t&&void 0!==e)i=t,n=e,this.container._width=t,this.container._height=e;else{var s=/(android)/i.test(window.navigator.userAgent),a=s?Math.min(document.documentElement.clientWidth,window.innerWidth||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),r=s?Math.min(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientHeight,window.innerHeight||0);i=o?a:this.container.clientWidth,n=o?r:this.container.clientHeight,this.container._width=i,this.container._height=n}this.camera.aspect=i/n,this.camera.updateProjectionMatrix(),this.renderer.setSize(i,n),(this.options.enableReticle||this.tempEnableReticle)&&this.updateReticleEvent(),this.dispatchEvent({type:"window-resize",width:i,height:n}),this.scene.traverse(function(t){t.dispatchEvent&&t.dispatchEvent({type:"window-resize",width:i,height:n})})},addOutputElement:function(){},outputPosition:function(){},onMouseDown:function(t){t.preventDefault(),this.userMouse.x=0<=t.clientX?t.clientX:t.touches[0].clientX,this.userMouse.y=0<=t.clientY?t.clientY:t.touches[0].clientY,this.userMouse.type="mousedown",this.onTap(t)},onMouseMove:function(t){t.preventDefault(),this.userMouse.type="mousemove",this.onTap(t)},onMouseUp:function(t){var e=!1;this.userMouse.type="mouseup";var i=this.userMouse.x>=t.clientX-this.options.clickTolerance&&this.userMouse.x<=t.clientX+this.options.clickTolerance&&this.userMouse.y>=t.clientY-this.options.clickTolerance&&this.userMouse.y<=t.clientY+this.options.clickTolerance||t.changedTouches&&this.userMouse.x>=t.changedTouches[0].clientX-this.options.clickTolerance&&this.userMouse.x<=t.changedTouches[0].clientX+this.options.clickTolerance&&this.userMouse.y>=t.changedTouches[0].clientY-this.options.clickTolerance&&this.userMouse.y<=t.changedTouches[0].clientY+this.options.clickTolerance?"click":void 0;if((!t||!t.target||t.target.classList.contains("panolens-canvas"))&&(t.preventDefault(),e=t.changedTouches&&1===t.changedTouches.length?this.onTap({clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY},i):this.onTap(t,i),this.userMouse.type="none",!e&&"click"===i)){var n=this.options,o=n.autoHideInfospot,s=n.autoHideControlBar,a=this.panorama,r=this.toggleControlBar;o&&a&&a.toggleInfospotVisibility(),s&&r()}},onTap:function(t,e){var i=this.container.getBoundingClientRect(),n=i.left,o=i.top,s=this.container,a=s.clientWidth,r=s.clientHeight;if(this.raycasterPoint.x=(t.clientX-n)/a*2-1,this.raycasterPoint.y=-(t.clientY-o)/r*2+1,this.raycaster.setFromCamera(this.raycasterPoint,this.camera),this.panorama){("mousedown"!==t.type&&this.touchSupported||this.OUTPUT_INFOSPOT)&&this.outputPosition();var c=this.raycaster.intersectObjects(this.panorama.children,!0),h=this.getConvertedIntersect(c),d=0<c.length?c[0].object:void 0;if("mouseup"===this.userMouse.type&&(h&&this.pressEntityObject===h&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:t}),this.pressEntityObject=void 0),"mouseup"===this.userMouse.type&&(d&&this.pressObject===d&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:t}),this.pressObject=void 0),"click"===e?(this.panorama.dispatchEvent({type:"click",intersects:c,mouseEvent:t}),h&&h.dispatchEvent&&h.dispatchEvent({type:"click-entity",mouseEvent:t}),d&&d.dispatchEvent&&d.dispatchEvent({type:"click",mouseEvent:t})):(this.panorama.dispatchEvent({type:"hover",intersects:c,mouseEvent:t}),(this.hoverObject&&0<c.length&&this.hoverObject!==h||this.hoverObject&&0===c.length)&&(this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverleave",mouseEvent:t}),this.reticle.end()),this.hoverObject=void 0),h&&0<c.length&&(this.hoverObject!==h&&(this.hoverObject=h,this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverenter",mouseEvent:t}),(this.options.autoReticleSelect&&this.options.enableReticle||this.tempEnableReticle)&&this.reticle.start(this.onTap.bind(this,t,"click")))),"mousedown"===this.userMouse.type&&this.pressEntityObject!=h&&(this.pressEntityObject=h,this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstart-entity",mouseEvent:t})),"mousedown"===this.userMouse.type&&this.pressObject!=d&&(this.pressObject=d,this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstart",mouseEvent:t})),"mousemove"!==this.userMouse.type&&!this.options.enableReticle||(d&&d.dispatchEvent&&d.dispatchEvent({type:"hover",mouseEvent:t}),this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressmove-entity",mouseEvent:t}),this.pressObject&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressmove",mouseEvent:t}))),!h&&this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&(this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:t}),this.pressEntityObject=void 0),!d&&this.pressObject&&this.pressObject.dispatchEvent&&(this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:t}),this.pressObject=void 0)),d&&d instanceof Infospot&&(this.infospot=d,"click"===e))return!0;this.options.autoRotate&&"mousemove"!==this.userMouse.type&&(clearTimeout(this.autoRotateRequestId),this.control===this.OrbitControls&&(this.OrbitControls.autoRotate=!1,this.autoRotateRequestId=window.setTimeout(this.enableAutoRate.bind(this),this.options.autoRotateActivationDuration)))}},getConvertedIntersect:function(t){for(var e=void 0,i=0;i<t.length;i++)if(0<=t[i].distance&&t[i].object&&!t[i].object.passThrough){if(t[i].object.entity&&t[i].object.entity.passThrough)continue;if(t[i].object.entity&&!t[i].object.entity.passThrough){e=t[i].object.entity;break}e=t[i].object;break}return e},toggleControlBar:function(){},onKeyDown:function(t){this.options.output&&"none"!==this.options.output&&"Control"===t.key&&(this.OUTPUT_INFOSPOT=!0)},onKeyUp:function(){this.OUTPUT_INFOSPOT=!1},update:function(){u.update(),this.updateCallbacks.forEach(function(t){t()}),this.control.update(),this.scene.traverse(function(t){}.bind(this))},render:function(){this.mode===r.CARDBOARD||this.mode===r.STEREO?(this.renderer.clear(),this.effect.render(this.scene,this.camera),this.effect.render(this.sceneReticle,this.camera)):(this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.renderer.clearDepth(),this.renderer.render(this.sceneReticle,this.camera))},animate:function(){this.requestAnimationId=window.requestAnimationFrame(this.animate.bind(this)),this.onChange()},onChange:function(){this.update(),this.render()},registerMouseAndTouchEvents:function(){var t={passive:!1};this.container.addEventListener("mousedown",this.HANDLER_MOUSE_DOWN,t),this.container.addEventListener("mousemove",this.HANDLER_MOUSE_MOVE,t),this.container.addEventListener("mouseup",this.HANDLER_MOUSE_UP,t),this.container.addEventListener("touchstart",this.HANDLER_MOUSE_DOWN,t),this.container.addEventListener("touchend",this.HANDLER_MOUSE_UP,t)},unregisterMouseAndTouchEvents:function(){this.container.removeEventListener("mousedown",this.HANDLER_MOUSE_DOWN,!1),this.container.removeEventListener("mousemove",this.HANDLER_MOUSE_MOVE,!1),this.container.removeEventListener("mouseup",this.HANDLER_MOUSE_UP,!1),this.container.removeEventListener("touchstart",this.HANDLER_MOUSE_DOWN,!1),this.container.removeEventListener("touchend",this.HANDLER_MOUSE_UP,!1)},registerReticleEvent:function(){this.addUpdateCallback(this.HANDLER_TAP)},unregisterReticleEvent:function(){this.removeUpdateCallback(this.HANDLER_TAP)},updateReticleEvent:function(){var t=this.container.clientWidth/2+this.container.offsetLeft,e=this.container.clientHeight/2;this.removeUpdateCallback(this.HANDLER_TAP),this.HANDLER_TAP=this.onTap.bind(this,{clientX:t,clientY:e}),this.addUpdateCallback(this.HANDLER_TAP)},registerEventListeners:function(){window.addEventListener("resize",this.HANDLER_WINDOW_RESIZE,!0),window.addEventListener("keydown",this.HANDLER_KEY_DOWN,!0),window.addEventListener("keyup",this.HANDLER_KEY_UP,!0)},unregisterEventListeners:function(){window.removeEventListener("resize",this.HANDLER_WINDOW_RESIZE,!0),window.removeEventListener("keydown",this.HANDLER_KEY_DOWN,!0),window.removeEventListener("keyup",this.HANDLER_KEY_UP,!0)},dispose:function(){this.tweenLeftAnimation.stop(),this.tweenUpAnimation.stop(),this.unregisterEventListeners(),function t(e){for(var i=e.children.length-1;0<=i;i--)t(e.children[i]),e.remove(e.children[i]);e instanceof p?(e.dispose(),e=null):e.dispatchEvent&&e.dispatchEvent("dispose")}(this.scene),this.widget&&(this.widget.dispose(),this.widget=null),G.Cache&&G.Cache.enabled&&G.Cache.clear()},destroy:function(){this.dispose(),this.render(),window.cancelAnimationFrame(this.requestAnimationId)},onPanoramaDispose:function(t){t===this.panorama&&(this.panorama=null)},loadAsyncRequest:function(t,e){var i=1<arguments.length&&void 0!==e?e:function(){},n=new window.XMLHttpRequest;n.onloadend=function(t){i(t)},n.open("GET",t,!0),n.send(null)},addViewIndicator:function(){},appendControlItem:function(){},clearAllCache:function(){G.Cache.clear()}}),G.REVISION!=o&&console.warn("three.js version is not matched. Please consider use the target revision "+o),window.TWEEN=u,t.CONTROLS=a,t.DataImage=v,t.ImageLoader=c,t.ImagePanorama=m,t.MODES=r,t.Panorama=p,t.REVISION=n,t.Reticle=d,t.THREE_REVISION=o,t.THREE_VERSION=s,t.TextureLoader=h,t.VERSION="0.11.0",t.Viewer=y,t.Widget=A,Object.defineProperty(t,"__esModule",{value:!0})}(t.BAIVLENS={},t.BAIV3);